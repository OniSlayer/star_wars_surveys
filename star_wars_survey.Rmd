---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.1'
      jupytext_version: 1.1.3
  kernelspec:
    display_name: Python 3
    language: python
    name: python3
---

# Star Wars Survey

This proyect is about analyzing star wars related surveys with a focus on cleaning and wrangling with the data

```{python}
# !ls data
```

```{python}
# Reading the star wars data
import pandas as pd
star_wars = pd.read_csv('data/star_wars.csv', encoding= 'ISO-8859-1')
```

```{python}
pd.set_option('display.max_columns', 500)
```

```{python}
# Exploratory analysis of the data
star_wars.head()
```

```{python}
# Inspecting the attributes on the relation
star_wars.columns
```

```{python}
# There is one emtpy value that has a null in the RespondentID field
# This row is removed
star_wars = star_wars[star_wars['RespondentID'].notnull()]
```

```{python}
# The'Have you seen any of the 6 films in the Star Wars franchise?' column and the 
# 'Do you consider yourself to be a fan of the Star Wars film franchise?' column are key

star_wars['Have you seen any of the 6 films in the Star Wars franchise?'].value_counts(dropna = False)
```

```{python}
star_wars['Do you consider yourself to be a fan of the Star Wars film franchise?'].value_counts(dropna = False)
```

```{python}
# The conversion of the 'Yes' and 'No' values to booleans can be made with the s.map method and a 
# dictionary

yn_dict = {
    'Yes': True,
    'No': False
}

star_wars['Do you consider yourself to be a fan of the Star Wars film franchise?'] = star_wars['Do you consider yourself to be a fan of the Star Wars film franchise?'].map(yn_dict)
star_wars['Have you seen any of the 6 films in the Star Wars franchise?'] = star_wars['Have you seen any of the 6 films in the Star Wars franchise?'].map(yn_dict)
```

```{python}
star_wars['Have you seen any of the 6 films in the Star Wars franchise?'].value_counts(dropna = False)
```

```{python}
star_wars['Do you consider yourself to be a fan of the Star Wars film franchise?'].value_counts(dropna = False)
```

```{python}
# Convering the values of columns 3 to 9 to booleans

movies = star_wars.columns[3:9]

for movie in movies:
    star_wars[movie] = star_wars[movie].notna()
    print(star_wars[movie].value_counts(dropna= False))
```

```{python}
# Renaming the seen movies related attributes
seen_movie_dict = {
    'Which of the following Star Wars films have you seen? Please select all that apply.' : 'seen_1',
    'Unnamed: 4': 'seen_2',
    'Unnamed: 5': 'seen_3',
    'Unnamed: 6': 'seen_4',
    'Unnamed: 7': 'seen_5',
    'Unnamed: 8': 'seen_6'
}

star_wars = star_wars.rename(columns = seen_movie_dict)
star_wars.head()
```

```{python}
# Converting the rating related columns to numbers

star_wars[star_wars.columns[9:15]] = star_wars[star_wars.columns[9:15]].astype(float)
```

```{python}
# Changing the name of rating related columns 

rating_names = {
    'Please rank the Star Wars films in order of preference with 1 being your favorite film in the franchise and 6 being your least favorite film.': 'ranking_1',
    'Unnamed: 10': 'ranking_2',
    'Unnamed: 11': 'ranking_3',
    'Unnamed: 12': 'ranking_4',
    'Unnamed: 13': 'ranking_5',
    'Unnamed: 14': 'ranking_6'
}

star_wars.rename(columns = rating_names, inplace = True)
star_wars.head()
```

```{python}

```
